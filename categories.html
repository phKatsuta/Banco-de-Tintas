<?php
// Configurações de conexão com o banco de dados
$servername = "localhost";
$username = "root";
$password = "";
$dbname = "seu_banco_de_dados";

// Criar conexão
$conn = new mysqli($servername, $username, $password, $dbname);

// Verificar a conexão
if ($conn->connect_error) {
    die("Erro na conexão com o banco de dados.");
}

// Verificar se o formulário foi enviado
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $usuario_nome = trim($_POST['usuario_nome']);
    $usuario_email = trim($_POST['usuario_email']);
    $senha = trim($_POST['senha']);
    $usuario_cep = trim($_POST['usuario_cep']);
    $usuario_endereco = trim($_POST['usuario_endereco']);
    $usuario_endereco_num = trim($_POST['usuario_endereco_num']);
    $usuario_endereco_complemento = trim($_POST['usuario_endereco_complemento']);
    $usuario_bairro = trim($_POST['usuario_bairro']);
    $usuario_cidade = trim($_POST['usuario_cidade']);
    $usuario_estado = trim($_POST['usuario_estado']);
    $usuario_documento = trim($_POST['usuario_documento']);
    $telefone = trim($_POST['telefone']);
    $eh_empresa = intval($_POST['eh_empresa']);

    // Validação simples
    if (!filter_var($usuario_email, FILTER_VALIDATE_EMAIL)) {
        header("Location: cadastro_usuario.php?error=Email inválido");
        exit;
    }

    // Gerar hash seguro da senha
    $senha_hash = password_hash($senha, PASSWORD_DEFAULT);

    // Usar prepared statements para inserir dados
    $stmt = $conn->prepare("INSERT INTO usuarios (usuario_nome, usuario_email, senha, usuario_cep, usuario_endereco, usuario_endereco_num, usuario_endereco_complemento, usuario_bairro, usuario_cidade, usuario_estado, usuario_documento, telefone, eh_empresa) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");
    
    if ($stmt) {
        $stmt->bind_param("sssssssssssii", 
            $usuario_nome, $usuario_email, $senha_hash, $usuario_cep, $usuario_endereco, 
            $usuario_endereco_num, $usuario_endereco_complemento, $usuario_bairro, 
            $usuario_cidade, $usuario_estado, $usuario_documento, $telefone, $eh_empresa
        );

        if ($stmt->execute()) {
            header("Location: login.html?success=1");
            exit;
        } else {
            header("Location: cadastro_usuario.php?error=Erro ao cadastrar");
            exit;
        }

        $stmt->close();
    } else {
        header("Location: cadastro_usuario.php?error=Erro na preparação da consulta");
        exit;
    }
}

// Fechar a conexão
$conn->close();
?>


<!DOCTYPE html>
<html lang="zxx">
<head>
	<title>Game Warrior Template</title>
	<meta charset="UTF-8">
	<meta name="description" content="Game Warrior Template">
	<meta name="keywords" content="warrior, game, creative, html">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Favicon -->   
	<link href="img/favicon.ico" rel="shortcut icon"/>

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">

	<!-- Stylesheets -->
	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/font-awesome.min.css"/>
	<link rel="stylesheet" href="css/owl.carousel.css"/>
	<link rel="stylesheet" href="css/animate.css"/>

	<style>
		body {
			font-family: 'Roboto', sans-serif;
			background-color: #f4f4f4;
			margin: 0;
			padding: 0;
		}

		/* Header */
		.header-section {
			background-color: #222;
			padding: 20px 0;
		}

		.site-logo img {
			width: 150px;
		}

		.main-menu {
			list-style: none;
			padding: 0;
			text-align: center;
		}

		.main-menu li {
			display: inline;
			margin: 0 15px;
		}

		.main-menu li a {
			color: #fff;
			font-size: 16px;
			text-decoration: none;
		}

		/* Form Section */
		.registration-form {
			background-color: #fff;
			padding: 30px;
			max-width: 600px;
			margin: 50px auto;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			border-radius: 8px;
		}

		.registration-form h2 {
			font-size: 24px;
			margin-bottom: 20px;
			text-align: center;
			color: #222;
		}

		.form-group {
			margin-bottom: 20px;
		}

		.form-group label {
			display: block;
			color: #333;
			font-size: 14px;
			font-weight: 500;
		}

		.form-group input,
		.form-group select {
			width: 100%;
			padding: 12px;
			border: 1px solid #ccc;
			border-radius: 5px;
			font-size: 14px;
			background-color: #f9f9f9;
		}

		.form-group input:focus,
		.form-group select:focus {
			outline: none;
			border-color: #222;
			background-color: #fff;
		}

		.btn-primary {
			background-color: #222;
			color: #fff;
			padding: 12px 20px;
			border: none;
			border-radius: 5px;
			font-size: 16px;
			cursor: pointer;
			width: 100%;
		}

		.btn-primary:hover {
			background-color: #333;
		}

		/* Footer */
		.footer-section {
			background-color: #222;
			color: #fff;
			padding: 30px 0;
			text-align: center;
		}

		.footer-menu {
			list-style: none;
			padding: 0;
			margin-bottom: 20px;
		}

		.footer-menu li {
			display: inline;
			margin: 0 15px;
		}

		.footer-menu li a {
			color: #fff;
			text-decoration: none;
		}

		.copyright {
			font-size: 14px;
			color: #fff;
			margin-top: 20px;
		}
	</style>

</head>
<body>
	<!-- Page Preloder -->
	<div id="preloder">
		<div class="loader"></div>
	</div>

	<!-- Header section -->
	<header class="header-section">
		<div class="container">
			<!-- logo -->
			<a class="site-logo" href="index.html">
				<img src="img/logo.png" alt="">
			</a>
			<!-- site menu -->
			<nav class="main-menu">
				<ul>
					<li><a href="index.html">Home</a></li>
					<li><a href="review.html">Banco de Tintas</a></li>					
					<li><a href="contact.html">Contato</a></li>
					<li><a href="community.html">Sobre o Projeto</a></li>		
					<li><a href="single-blog.html">Login</a></li> <!-- Adicionado botão de Login -->
					
				</ul>
			</nav>
		</div>
	</header>
	<!-- Header section end -->

	<!-- Cadastro de Usuário -->
	<section class="registration-form">
		<div class="container">
			<h2>Cadastro de Usuário</h2>
			<form action="cadastro_usuario.php" method="POST">
				<div class="form-group">
					<label for="usuario_nome">Nome Completo:</label>
					<input type="text" id="usuario_nome" name="usuario_nome" class="form-control" required>
				</div>
				<div class="form-group">
					<label for="usuario_email">E-mail:</label>
					<input type="email" id="usuario_email" name="usuario_email" class="form-control" required>
				</div>
				<div class="form-group">
					<label for="senha">Senha:</label>
					<input type="password" id="senha" name="senha" class="form-control" required>
				</div>
				<div class="form-group">
					<label for="usuario_cep">CEP:</label>
					<input type="text" id="usuario_cep" name="usuario_cep" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_endereco">Endereço:</label>
					<input type="text" id="usuario_endereco" name="usuario_endereco" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_endereco_num">Número:</label>
					<input type="text" id="usuario_endereco_num" name="usuario_endereco_num" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_endereco_complemento">Complemento:</label>
					<input type="text" id="usuario_endereco_complemento" name="usuario_endereco_complemento" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_bairro">Bairro:</label>
					<input type="text" id="usuario_bairro" name="usuario_bairro" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_cidade">Cidade:</label>
					<input type="text" id="usuario_cidade" name="usuario_cidade" class="form-control">
				</div>
				<div class="form-group">
					<label for="usuario_estado">Estado (UF):</label>
					<input type="text" id="usuario_estado" name="usuario_estado" class="form-control" maxlength="2">
				</div>
				<div class="form-group">
					<label for="usuario_documento">Documento (CPF ou CNPJ):</label>
					<input type="text" id="usuario_documento" name="usuario_documento" class="form-control">
				</div>
				<div class="form-group">
					<label for="telefone">Telefone:</label>
					<input type="text" id="telefone" name="telefone" class="form-control" maxlength="11">
				</div>
				<div class="form-group">
					<label for="eh_empresa">É uma empresa?</label>
					<select id="eh_empresa" name="eh_empresa" class="form-control">
						<option value="0">Não</option>
						<option value="1">Sim</option>
					</select>
				</div>
				<button type="submit" class="btn-primary">Cadastrar</button>
			</form>
		</div>
	</section>
	<!-- Cadastro de Usuário end -->

	<!-- Footer section -->
	<footer class="footer-section">
		<div class="container">
			<ul class="footer-menu">
				<li><a href="index.html">Home</a></li>
				<li><a href="review.html">Banco de Tintas</a></li>
				<li><a href="contact.html">Contato</a></li>
			</ul>
			<p class="copyright">
				Copyright &copy;<script>document.write(new Date().getFullYear());</script> Todos os direitos reservados | Este template foi feito por <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
			</p>
		</div>
	</footer>
	<!-- Footer section end -->

	<!--====== Javascripts & Jquery ======-->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.marquee.min.js"></script>
	<script src="js/main.js"></script>
</body>
</html>
